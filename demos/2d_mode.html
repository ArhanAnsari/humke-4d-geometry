<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>4D Geometry Viewer</title>
	<script src="../mathbox-src/build/mathbox-bundle.js"></script>
  	<link rel="stylesheet" href="../../build/mathbox.css">
  	<script src="../datgui/dat.gui.js"></script>
  	<meta name="viewport" content="initial-scale=1, maximum-scale=1">
  	<!-- http://silentmatt.com/javascript-expression-evaluator/ -->
	<script src="../parser.js"></script>
</head>
<body>
<script type="text/javascript">
	// Initialize mathbox 
	var mathbox = mathBox({
      plugins: ['core', 'controls', 'cursor', 'mathbox'],
      controls: {
        // Orbit controls, i.e. Euler angles, with gimbal lock
        klass: THREE.OrbitControls,

        // Trackball controls, i.e. Free quaternion rotation
        //klass: THREE.TrackballControls,
      },
    });
    if (mathbox.fallback) throw "WebGL not supported"

    var three = mathbox.three;
    three.renderer.setClearColor(new THREE.Color(0xFFFFFF), 1.0);

    //Init the GUI
    function initGUI(){
    	var params = {
	    	'axis_value':0,
	    	'axis':'X',
	    	'equation': 'y=sin(x)',
	    	'points': '(0,0),(0,1)',
	    	'source': 'equation',
	    	'fill':false,
	    	'show_shape':true,
	    	'show_axis':true
	    }
	    var gui = new dat.GUI();
	    // Setup folders 
	    var shapeProperties = gui.addFolder('Shape Properties');
	    var viewing = gui.addFolder('Viewing Controls');

	    // Add shape options 
	    // Should be able to: (1) Draw from equation (2) Draw from points and (a) fill or outline.
	    shapeProperties.add(params, 'equation');
	    shapeProperties.add(params, 'points');
	    shapeProperties.add(params, 'fill');
	    shapeProperties.add(params, 'source',['equation','points']);
	    shapeProperties.add(params, 'show_shape');

	    // Add viewing options
	    var axis_control = viewing.add(params, 'axis_value').min(-10).max(10).step(0.01).name('X = ').listen()
	    viewing.add(params, 'axis', [ 'X', 'Y'] ).onChange(function(val){
	    	axis_control.name(val + " = ")
	    	params.axis_value = 0;
	    });
	    viewing.add(params, 'show_axis');

	    
    }

    initGUI()
    

	// 1- We need a 3D camera
	var camera = mathbox.camera({
	  proxy: true, // this alows interactive camera controls to override the position
	  position: [0, 0, 3],
	})

	mathbox.print(); // Prints out the state of the Mathbox DOM

	// 2- Set up our coordinate system 
	var view = mathbox.cartesian({
	  range: [[-10, 10], [-10, 10]],
	  scale: [1, 1],
	});


	// Add axes and a grid 
	view
	  .axis({
	    axis: 1,
	    width: 4,
	    color:'black',
	  })
	  .axis({
	    axis: 2,
	    width: 4,
	    color:'black',
	  })
	  .grid({
	    width: 1, 
	    divideX: 10,
	    divideY: 10        
	  });



	  // 3- Give it some geometrical data 
	  var data =
	  view.interval({
	    expr: function (emit, x, i, t) {
	      emit(x, Math.sin(x) * 3);
	    },
	    width: 256,
	    channels: 2,
	  });


	  // 4- The shape to draw 
	  var curve =
		  view.line({
		    width: 5,
		    color: '#3090FF',
		  });

	// Add text
	view.array({
      data: [[11,1], [0,12]],
      channels: 2, // necessary
      live: false,
    }).text({
      data: ["x", "y"],
    }).label({
      color: 0x000000,
    });

    //mathbox.set('focus', 2);

    
    // Create the other coordinate system 
    var view2 = mathbox.cartesian({
	  range: [[-10, 10],[-10,10]],
	  scale: [1, 1],
	});

    view2 = view2.transform({
      position: [30, 0, 0],
    })

	view2.axis({
	    axis: 1,
	    width: 4,
	    color:'black',
	  })
	  
	view2.array({
      data: [[11,1]],
      channels: 2, // necessary
      live: false,
    }).text({
      data: ["x"],
    }).label({
      color: 0x000000,
    });

	/* 
	
	*/	 

</script>
</body>
</html>